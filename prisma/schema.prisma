generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =================== Enums ===================
enum Role {
  USER
  ADMIN
  SUPER_ADMIN
}

enum ContentStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

// enum OrderStatus {
//   PENDING
//   PAID
//   CANCELED
//   FAILED
//   SHIPPED
//   COMPLETED
// }

// =================== Admin ===================
model Admin {
  id           String   @id @default(uuid()) @db.Uuid
  name         String   @db.VarChar(100)
  email        String   @unique @db.VarChar(255)
  password     String   @db.VarChar(255)
  permissions  String[] @default([])
  role         Role     @default(ADMIN)
  lastEditedBy String?  @db.VarChar(255)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([email])
}

// =================== User ===================
model User {
  id                     String   @id @default(uuid()) @db.Uuid
  firstName              String   @db.VarChar(100)
  lastName               String   @db.VarChar(100)
  email                  String   @unique @db.VarChar(255)
  password               String   @db.VarChar(255)
  role                   Role     @default(USER)
  isEmailVerified        Boolean  @default(false)
  isNewsletterSubscribed Boolean  @default(false)
  // orders                 Order[]  @relation(name: "UserOrders")
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt

  @@index([email])
}

// =================== Category ===================
model Category {
  id               String        @id @default(uuid()) @db.Uuid
  name             String        @unique @db.VarChar(100)
  description      String?       @db.Text()
  shortDescription String?       @db.VarChar(255)
  slug             String?       @db.VarChar(255)
  metaTitle        String?       @db.VarChar(70)
  metaDescription  String?       @db.VarChar(160)
  canonicalTag     String?       @db.VarChar(255)
  breadcrumb       String?       @db.VarChar(255)
  posterImageUrl   String?       @db.VarChar(512)
  seoSchema        String?       @db.Text()
  lastEditedBy     String?       @db.VarChar(255)
  status           ContentStatus @default(PUBLISHED)
  products         Product[]     @relation(name: "CategoryProducts")
  subcategories    Subcategory[] @relation(name: "CategorySubcategories")
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt

  @@index([name])
  @@index([slug])
}

// =================== Subcategory ===================
model Subcategory {
  id               String        @id @default(uuid()) @db.Uuid
  categoryId       String        @db.Uuid
  name             String        @db.VarChar(100)
  description      String?       @db.Text()
  shortDescription String?       @db.VarChar(255)
  slug             String?       @db.VarChar(255)
  metaTitle        String?       @db.VarChar(70)
  metaDescription  String?       @db.VarChar(160)
  canonicalTag     String?       @db.VarChar(255)
  breadcrumb       String?       @db.VarChar(255)
  posterImageUrl   String?       @db.VarChar(512)
  seoSchema        String?       @db.Text()
  lastEditedBy     String?       @db.VarChar(255)
  status           ContentStatus @default(PUBLISHED)
  category         Category      @relation(name: "CategorySubcategories", fields: [categoryId], references: [id], onDelete: Cascade)
  products         Product[]     @relation(name: "SubcategoryProducts")
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt

  @@index([categoryId])
  @@index([slug])
}

// =================== Product ===================
model Product {
  id               String        @id @default(uuid()) @db.Uuid
  categoryId       String        @db.Uuid
  subcategoryId    String        @db.Uuid
  name             String        @db.VarChar(100)
  description      String?       @db.Text()
  shortDescription String?       @db.VarChar(255)
  slug             String        @db.VarChar(255)
  metaTitle        String?       @db.VarChar(120)
  metaDescription  String?       @db.VarChar(160)
  canonicalTag     String?       @db.VarChar(255)
  breadcrumb       String?       @db.VarChar(255)
  posterImageUrl   String        @db.VarChar(512)
  seoSchema        String?       @db.Text()
  productImages    String[]      @default([])
  price            Decimal       @default(0)
  discountPrice    Decimal?      @default(0)
  motorPrice       Decimal?      @default(0)
  stock            Int           @default(0)
  height           Decimal?      @default(0)
  width            Decimal?      @default(0)
  color            String?       @db.VarChar(100)
  pattern          String?       @db.VarChar(100)
  composition      String?       @db.VarChar(255)
  isMotorized      Boolean       @default(false)
  additionalInfo   String?       @db.Text()
  measuringGuide   String?       @db.Text()
  lastEditedBy     String?       @db.VarChar(255)
  status           ContentStatus @default(PUBLISHED)
  category         Category      @relation(name: "CategoryProducts", fields: [categoryId], references: [id], onDelete: Cascade)
  subcategory      Subcategory   @relation(name: "SubcategoryProducts", fields: [subcategoryId], references: [id], onDelete: Cascade)
  // orderItems       OrderItem[]   @relation(name: "ProductOrderItems")
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt

  @@index([name])
  @@index([categoryId])
  @@index([subcategoryId])
  @@index([price])
  @@index([slug])
}

// // =================== Order ===================
// model Order {
//   id             String      @id @default(uuid()) @db.Uuid
//   userId         String      @db.Uuid
//   firstName      String      @db.VarChar(100)
//   lastName       String      @db.VarChar(100)
//   email          String      @db.VarChar(255)
//   phone          String      @db.VarChar(20)
//   city           String      @db.VarChar(100)
//   country        String      @db.VarChar(100)
//   address        String?     @db.Text()
//   emirate        String      @db.VarChar(100)
//   totalAmount    Decimal     @default(0)
//   shippingCost   Decimal     @default(0)
//   paymentStatus  Boolean     @default(false)
//   shippingMethod Json?       @db.Json
//   lastEditedBy   String?     @db.VarChar(255)
//   status         OrderStatus @default(PENDING)
//   user           User        @relation(name: "UserOrders", fields: [userId], references: [id], onDelete: Restrict)
//   items          OrderItem[] @relation(name: "OrderItems")
//   createdAt      DateTime    @default(now())
//   updatedAt      DateTime    @default(now()) @updatedAt
// }

// // =================== OrderItem ===================
// model OrderItem {
//   id           String   @id @default(uuid()) @db.Uuid
//   orderId      String   @db.Uuid
//   productId    String   @db.Uuid
//   productName  String   @db.VarChar(255)
//   productImage String?  @db.VarChar(512)
//   quantity     Int      @default(1)
//   price        Decimal  @default(0)
//   lastEditedBy String?  @db.VarChar(255)
//   order        Order    @relation(name: "OrderItems", fields: [orderId], references: [id], onDelete: Cascade)
//   product      Product  @relation(name: "ProductOrderItems", fields: [productId], references: [id])
//   createdAt    DateTime @default(now())
//   updatedAt    DateTime @updatedAt

//   @@index([orderId])
//   @@index([productId])
// }
