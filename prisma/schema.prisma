generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  USER
  ADMIN
  SUPER_ADMIN
}

enum ContentStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

enum OrderStatus {
  PENDING
  PAID
  CANCELED
  FAILED
  SHIPPED
  COMPLETED
}

enum PaymentStatus {
  FREE
  PENDING
  PAID
  CANCELED
  FAILED
}

enum InquiryType {
  EMAIL
  PHONE
  WHATSAPP
  OTHER
}

enum InquiryStatus {
  NEW
  READ
  RESOLVED
}

enum Permissions {
  ADD_PRODUCTS
  EDIT_PRODUCTS
  DELETE_PRODUCTS
  ADD_CATEGORY
  DELETE_CATEGORY
  EDIT_CATEGORY
  CHECK_PROFIT
  CHECK_REVENUE
  CHECK_VISITORS
  VIEW_USERS
  VIEW_SALES
  VIEW_ADMINS
  VIEW_TOTAL_PRODUCTS
  VIEW_TOTAL_CATEGORIES
}

model Admin {
  id           String        @id @default(uuid()) @db.Uuid
  name         String        @db.VarChar(100)
  email        String        @unique @db.VarChar(255)
  password     String        @db.VarChar(255)
  permissions  Permissions[] @default([])
  role         Role          @default(ADMIN)
  lastEditedBy String?       @db.VarChar(255)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model User {
  id                       String    @id @default(uuid()) @db.Uuid
  firstName                String    @db.VarChar(100)
  lastName                 String    @db.VarChar(100)
  email                    String    @unique
  password                 String    @db.VarChar(255)
  role                     Role      @default(USER)
  isEmailVerified          Boolean   @default(false)
  defaultShippingAddressId String?
  defaultBillingAddressId  String?
  addresses                Address[] @relation(name: "UserAddresses")
  orders                   Order[]   @relation(name: "UserOrders")
  createdAt                DateTime  @default(now())
  updatedAt                DateTime  @updatedAt
}

model Address {
  id          String   @id @default(uuid()) @db.Uuid
  userId      String   @db.Uuid
  firstName   String   @db.VarChar(100)
  lastName    String   @db.VarChar(100)
  email       String   @db.VarChar(255)
  phone       String   @db.VarChar(20)
  state       String   @db.VarChar(100)
  country     String   @db.VarChar(100)
  city        String   @db.VarChar(100)
  address     String   @db.VarChar(255)
  addressType String   @db.VarChar(255)
  user        User     @relation(name: "UserAddresses", fields: [userId], references: [id], onDelete: Cascade)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model NewsletterSubscriber {
  id        String   @id @default(uuid()) @db.Uuid
  email     String   @unique @db.VarChar(255)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Category {
  id               String        @id @default(uuid()) @db.Uuid
  name             String        @unique @db.VarChar(100)
  description      String?       @db.Text()
  shortDescription String?       @db.VarChar(255)
  slug             String        @unique @db.VarChar(255)
  metaTitle        String?       @db.VarChar(70)
  metaDescription  String?       @db.VarChar(160)
  canonicalTag     String?       @db.VarChar(255)
  breadcrumb       String?       @db.VarChar(255)
  posterImageUrl   String?       @db.VarChar(512)
  seoSchema        String?       @db.Text()
  lastEditedBy     String?       @db.VarChar(255)
  status           ContentStatus @default(PUBLISHED)
  products         Product[]     @relation(name: "CategoryProducts")
  subcategories    Subcategory[] @relation(name: "CategorySubcategories")
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
}

model Subcategory {
  id               String        @id @default(uuid()) @db.Uuid
  categoryId       String        @db.Uuid
  name             String        @db.VarChar(100)
  description      String?       @db.Text()
  shortDescription String?       @db.VarChar(255)
  slug             String        @db.VarChar(255)
  metaTitle        String?       @db.VarChar(70)
  metaDescription  String?       @db.VarChar(160)
  canonicalTag     String?       @db.VarChar(255)
  breadcrumb       String?       @db.VarChar(255)
  posterImageUrl   String?       @db.VarChar(512)
  seoSchema        String?       @db.Text()
  lastEditedBy     String?       @db.VarChar(255)
  status           ContentStatus @default(PUBLISHED)
  category         Category      @relation(name: "CategorySubcategories", fields: [categoryId], references: [id], onDelete: Cascade)
  products         Product[]     @relation(name: "SubcategoryProducts")
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
}

model Product {
  id               String        @id @default(uuid()) @db.Uuid
  categoryId       String        @db.Uuid
  subcategoryId    String        @db.Uuid
  name             String        @db.VarChar(100)
  description      String?       @db.Text()
  shortDescription String?       @db.VarChar(255)
  slug             String        @db.VarChar(255)
  metaTitle        String?       @db.VarChar(120)
  metaDescription  String?       @db.VarChar(160)
  canonicalTag     String?       @db.VarChar(255)
  breadcrumb       String?       @db.VarChar(255)
  posterImageUrl   String        @db.VarChar(512)
  seoSchema        String?       @db.Text()
  productImages    String[]      @default([])
  price            Decimal       @default(0)
  discountPrice    Decimal       @default(0)
  motorPrice       Decimal       @default(0)
  stock            Int           @default(0)
  height           Decimal       @default(0)
  width            Decimal       @default(0)
  color            String?       @db.VarChar(100)
  pattern          String?       @db.VarChar(100)
  composition      String?       @db.VarChar(255)
  isMotorized      Boolean       @default(false)
  additionalInfo   String?       @db.Text()
  measuringGuide   String?       @db.Text()
  lastEditedBy     String?       @db.VarChar(255)
  status           ContentStatus @default(PUBLISHED)
  category         Category      @relation(name: "CategoryProducts", fields: [categoryId], references: [id], onDelete: Cascade)
  subcategory      Subcategory   @relation(name: "SubcategoryProducts", fields: [subcategoryId], references: [id], onDelete: Cascade)
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
}

model Order {
  id            String        @id @default(uuid()) @db.Uuid
  userId        String        @db.Uuid
  firstName     String        @db.VarChar(100)
  lastName      String        @db.VarChar(100)
  email         String        @db.VarChar(255)
  phone         String        @db.VarChar(20)
  state         String        @db.VarChar(100)
  country       String        @db.VarChar(100)
  city          String        @db.VarChar(100)
  address       String        @db.Text()
  totalAmount   Decimal       @default(0)
  shippingCost  Decimal       @default(0)
  items         Json[]
  notes         String?       @db.Text()
  lastEditedBy  String?       @db.VarChar(255)
  paymentStatus PaymentStatus @default(PENDING)
  orderStatus   OrderStatus   @default(PENDING)
  user          User          @relation(name: "UserOrders", fields: [userId], references: [id], onDelete: Restrict)
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
}

model Inquiry {
  id            String        @id @default(uuid()) @db.Uuid
  name          String        @db.VarChar(100)
  email         String        @db.VarChar(255)
  phone         String        @db.VarChar(20)
  message       String?       @db.Text()
  inquiryType   InquiryType
  inquiryStatus InquiryStatus @default(NEW)
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
}
